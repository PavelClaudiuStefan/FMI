select last_name,salary,
       decode(commission_pct, null, 0, commission_pct) comision
       --decode(x, val11, val12, val21, val22, default
       --x modificam valorile campului x; val11 devine val12 etc
from employees;


select last_name, first_name, salary, nvl(commission_pct, 0) comision
from employees
order by decode(manager_id, null, 0, 1), comision;


select last_name, department_id
from employees
--where where department_id not in(null, 10, 20, 30) -> Gresit pentru ca nu compara cu null cum trebuie
where department_id not in(10, 20, 30) and department_id is not null;


--Versiunea 1
select employee_id, last_name, department_name
from employees, departments
where employees.department_id = departments.department_id;

--Versiune 2 imbunatatita
select employee_id, last_name, department_name
from employees JOIN departments
    on (employees.department_id = departments.department_id);
    
    
--Ex 8
select e.last_name, e.job_id, j.job_title, e.department_id
from employees e join jobs j
    on e.job_id = j.job_id
join departments d
    on e.department_id = d.department_id and e.department_id = 30;

-- Ex 9 Să se afişeze numele angajatului, numele departamentului şi orașul pentru toţi angajaţii care câştigă comision.
select e.last_name, e.first_name, d.department_name, c.country_name
from employees e join departments d
    on(e.department_id = d.department_id)
join locations l
    on(d.location_id = l.location_id)
join countries c
    on(l.country_id = c.country_id)
where e.commission_pct is not null and commission_pct > 0;


--Ex 11  Să se afişeze numele și denumirea jobului actual pentru angajații care au avut funcția de 'Stock Clerk'.
select e.last_name, e.first_name, j.job_title
from employees e join jobs j
    on (e.job_id = j.job_id and job_title = 'Stock Clerk')
join job_history h
    on j.job_id = h.job_id;
    

--Sa se afiseze numele fiecarui angajat si numele sefului direct
select e.last_name, e.first_name, m.last_name nume_sef, m.first_name prenume_sef
from employees e join employees m
    on e.manager_id = m.employee_id;



  
--Testing commands
select *
from employees


select *
from jobs;

select *
from departments;
